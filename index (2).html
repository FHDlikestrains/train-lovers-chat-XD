<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Train Lovers Chat XD</title>


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">


<style>
  body {
    margin:0;
    font-family: 'Press Start 2P', cursive;
    background:#111;
    color:#eee;
    display:flex;
    flex-direction:column;
    align-items:center;
  }
  h2 { font-size:14px; }
  input { margin:5px; padding:5px; width:180px; }
  button { margin:5px; padding:5px; cursor:pointer; }
  #chat {
    border:2px solid #eee;
    width:90%; max-width:500px;
    height:400px; overflow-y:auto;
    padding:5px; margin-top:10px;
    background:#000;
  }
  .message { margin:3px 0; }
  .username { font-weight:bold; }
  .pfp {
    width:20px; height:20px;
    border-radius:50%;
    vertical-align:middle;
    margin-right:5px;
  }
  #credits {
    margin-top:10px;
    font-size:10px;
    font-style:italic;
  }
</style>
</head>
<body>


<!-- GC PASS -->
<div id="passContainer">
  <h2>Enter GC Pass</h2>
  <input type="password" id="chatPassInput" placeholder="Enter pass">
  <button id="chatPassBtn">Enter</button>
</div>


<!-- AUTH FORMS -->
<div id="authContainer" style="display:none;">
  <div id="signupForm">
    <h2>Sign Up</h2>
    <input type="text" id="signupUsername" placeholder="Username">
    <input type="password" id="signupPassword" placeholder="Password">
    <button id="signupBtn">Sign Up</button>
    <p>Already have an account? <button id="loginBtn">I already have one</button></p>
  </div>


  <div id="loginForm" style="display:none;">
    <h2>Login</h2>
    <input type="text" id="loginUsername" placeholder="Username">
    <input type="password" id="loginPassword" placeholder="Password">
    <button id="loginSubmitBtn">Login</button>
    <p>Don't have an account? <button id="backToSignupBtn">Sign Up</button></p>
  </div>
</div>


<!-- CHAT AREA -->
<div id="chatContainer" style="display:none;">
  <div id="chat"></div>
  <input type="text" id="msgInput" placeholder="Type your message...">
  <button id="sendBtn">Send</button>
  <button id="uploadPFPBtn">Upload PFP</button>
</div>


<div id="credits">
  𝒢𝓇𝑜𝓊𝓅 𝒞𝒽𝒶𝓉 𝑀𝒶𝒹𝑒 𝑜𝒻 𝒮𝑜𝓂𝑒 𝐸𝓍𝓉𝓇𝑒𝓂𝑒𝓁𝓎 𝒰𝓃𝓈𝑒𝓇𝒾𝑜𝓊𝓈 𝒶𝓃𝒹 𝒰𝓃𝒻𝓊𝓃𝓃𝓎 𝐼𝓃𝒹𝒾𝓋𝒾𝒹𝓊𝒶𝓁𝓈
</div>


<script>
let username = '';
let userPFP = null;


// ====== GC PASS (HIDDEN VERSION) ======
const encodedGCpass = "RkhEIGxpa2VzIHV2b3I="; // "FHD likes uvor"
const correctPass = atob(encodedGCpass);


document.getElementById('chatPassBtn').addEventListener('click', () => {
  const inputPass = document.getElementById('chatPassInput').value.trim();


  if(inputPass === correctPass){
    document.getElementById('passContainer').style.display = 'none';
    document.getElementById('authContainer').style.display = 'block';
  } else {
    alert("Wrong GC Pass!");
  }
});


// ====== AUTH FORMS ======
const signupForm = document.getElementById('signupForm');
const loginForm = document.getElementById('loginForm');


document.getElementById('loginBtn').onclick = () => {
  signupForm.style.display = 'none';
  loginForm.style.display = 'block';
};
document.getElementById('backToSignupBtn').onclick = () => {
  loginForm.style.display = 'none';
  signupForm.style.display = 'block';
};


// ====== SIGNUP ======
document.getElementById('signupBtn').onclick = () => {
  const user = document.getElementById('signupUsername').value;
  const pass = document.getElementById('signupPassword').value;
  if(!user || !pass) return alert("Fill both fields");


  localStorage.setItem("user_"+user, pass);
  alert("Signed up!");
  username = user;
  showChat();
};


// ====== LOGIN ======
document.getElementById('loginSubmitBtn').onclick = () => {
  const user = document.getElementById('loginUsername').value;
  const pass = document.getElementById('loginPassword').value;


  const stored = localStorage.getItem("user_"+user);
  if(stored === pass){
    username = user;
    showChat();
  } else {
    alert("Wrong username or password!");
  }
};


// ====== SHOW CHAT ======
function showChat(){
  document.getElementById('authContainer').style.display = 'none';
  document.getElementById('chatContainer').style.display = 'block';
}


// ====== PFP ======
document.getElementById('uploadPFPBtn').onclick = () => {
  const input = document.createElement('input');
  input.type = 'file';
  input.accept = "image/*";
  input.onchange = e => {
    const file = e.target.files[0];
    const reader = new FileReader();
    reader.onload = ev => {
      userPFP = ev.target.result;
      alert("PFP uploaded!");
    };
    reader.readAsDataURL(file);
  };
  input.click();
};


// ====== SEND MESSAGE ======
const msgInput = document.getElementById('msgInput');
document.getElementById('sendBtn').onclick = sendMsg;
msgInput.addEventListener("keydown", e => {
  if(e.key === "Enter") sendMsg();
});


function sendMsg(){
  const text = msgInput.value.trim();
  if(!text) return;


  const chat = document.getElementById('chat');


  const div = document.createElement('div');
  div.className = "message";


  let html = "";
  if(userPFP) html += `<img src="${userPFP}" class="pfp">`;
  html += `<span class="username">${username}:</span> `;
  html += text.replace(/@(\w+)/g, "<b>@$1</b>");


  div.innerHTML = html;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;


  msgInput.value = "";
  beep();
}


// ====== BEEP ======
function beep(){
  const ctx = new (window.AudioContext || window.webkitAudioContext)();
  const osc = ctx.createOscillator();
  osc.type = "square";
  osc.frequency.setValueAtTime(440, ctx.currentTime);
  osc.connect(ctx.destination);
  osc.start();
  osc.stop(ctx.currentTime + 0.1);
}
</script>


</body>
</html>